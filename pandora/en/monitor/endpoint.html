<!DOCTYPE html>
<html lang="en">
<head>
  <title>EndPoint usage and extension - Ready to Boot</title>
  <meta charset="utf-8">
  <meta name="description" content="index.description">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" href="/pandora/css/index.css">

</head>
<body>
  <div class="nav" >
  <header>
    <a href="/pandora/en" class="nav-logo leftpadding" alt="Pandora.js"><img src="/pandora/images/nav-logo.png" > Pandora.js</a>
    <ul class="nav-item">
      <li><a href="/pandora/en/introduce.html" alt="Documentation">Documentation</a></li><li><a href="/pandora/en/api.html" alt="API reference">API reference</a></li><li><a href="https://github.com/midwayjs/pandora/releases" alt="Change Log">Change Log</a></li>
      <li class="translations">
        <a class="nav-link">English</a>
        <span class="arrow" style="border-top-color:#fff" ></span>
        <ul class="dropdown-content" >
          <li style="display: block; margin-left: 20px" ><a style="color: #008ce6" href="/pandora/zh-cn">中文</a></li>
          <li style="display: block; margin-left: 20px" ><a style="color: #008ce6" href="/pandora/en">English</a></li>
        </ul>
      </li>
      <li><iframe src="https://ghbtns.com/github-btn.html?user=midwayjs&repo=pandora&type=star&count=true" frameborder="0" scrolling="0" width="150px" height="20px"></iframe></li>
    </ul>
    <a id="mobileTrigger" href="#" class="mobile-trigger">
      <ul>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </a>
  </header>
</div>

  <div id="container" class="container">
    <div class="page-main">
  <article class="markdown-body">
    <h1>EndPoint usage and extension</h1>
    <p>EndPoint are pre-defined acceptors in Daemon for collecting each process'es Indicator data and group them by applications.</p>
<p>By default, Pandora.js provides a few EndPoint, all of them are open to user customization.</p>
<h2 id="define-endpoint"><a class="markdown-anchor" href="#define-endpoint">#</a> Define EndPoint</h2>
<p>Every EndPoint includes a name to tag its' uniqueness. And because EndPoint initialization was completed in Daemon, only one EndPoint instance exist according to the unique tag.</p>
<p>Each EndPoint is an IPC server, it accepts Indicator invocation results and summarises these data. Most commonly seen between theses methods are <code>invoke</code> and <code>processQueryResuts</code>, their definitions are as following:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> interface IEndPoint &#123;</span><br><span class="line">  indicators: <span class="built_in">Array</span>&lt;IIndicator&gt;;</span><br><span class="line">  group: string;</span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * invoke the following metrics</span></span><br><span class="line"><span class="comment">   * @param appName</span></span><br><span class="line"><span class="comment">   * @param args</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  invoke(appName: string, args?: any);</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * process responses</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  processQueryResults(results?: <span class="built_in">Array</span>&lt;IIndicatorResult&gt;): any;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>In the above code we used <code>interface</code> for definition and add <code>group</code> field for the EndPoint so that every Indicator has the same <code>group</code> could be be reported to the same EndPoint.</p>
<h2 id="define-indicator"><a class="markdown-anchor" href="#define-indicator">#</a> Define Indicator</h2>
<p>Each Indicator is an IPC client and initialized in different processes and sorted by pid. Generally speaking, one process only allow one Indicator which has the same name to exist. In cluster mode, Indicator can be used in various forms to report to EndPoint sharing the same group field name.</p>
<p>Indicator has a few important fields, kind of similar with EndPoint, <code>group</code> indicates the link to specific EndPoint while <code>invoke</code> method executes the real logics.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * single metric</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> interface IIndicator &#123;</span><br><span class="line">  group: string;</span><br><span class="line">  invoke(data?: any, builder?: IBuilder);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="convention-of-configuration"><a class="markdown-anchor" href="#convention-of-configuration">#</a> Convention of Configuration</h2>
<p>Configuration may differ between versions but most of it would be like this:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  actuator: &#123;</span><br><span class="line">    endPoint: &#123;</span><br><span class="line">      error: &#123;</span><br><span class="line">        enabled: <span class="literal">true</span>,</span><br><span class="line">        target: ErrorEndPoint,</span><br><span class="line">        resource: ErrorResource,</span><br><span class="line">        initConfig: &#123;</span><br><span class="line">          maxErrorCount: <span class="number">100</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      health: &#123;</span><br><span class="line">        enabled: <span class="literal">true</span>,</span><br><span class="line">        target: HealthEndPoint,</span><br><span class="line">        resource: HealthResource,</span><br><span class="line">        initConfig: &#123;</span><br><span class="line">          port: &#123;</span><br><span class="line">            enabled: <span class="literal">true</span>,</span><br><span class="line">            checkUrl: <span class="string">`http://127.1:6001`</span></span><br><span class="line">          &#125;,</span><br><span class="line">          disk_space: &#123;</span><br><span class="line">            enabled: <span class="literal">true</span>,</span><br><span class="line">            rate: <span class="number">80</span>,</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      process: &#123;</span><br><span class="line">        enabled: <span class="literal">true</span>,</span><br><span class="line">        target: ProcessEndPoint,</span><br><span class="line">      &#125;,</span><br><span class="line">      metrics: &#123;</span><br><span class="line">        enabled: <span class="literal">true</span>,</span><br><span class="line">        target: MetricsEndPoint,</span><br><span class="line">        resource: MetricsResource</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  ...</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>Each EndPoint has a few common configurations:</p>
<ul>
<li>name {String} unique globally</li>
<li>enabled {Boolean} enabled or not</li>
<li>target {IEndPoint} corresponding EndPoint class</li>
<li>resource {ActuatorResource} corresponding Resource class</li>
<li>initConfig {Object} initialization configuration</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">metrics: &#123;</span><br><span class="line">  enabled: <span class="literal">true</span>,</span><br><span class="line">  target: MetricsEndPoint,</span><br><span class="line">  resource: MetricsResource</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Above is the code for EndPoint configuration.</p>

  </article>
  <aside id="mobileAside" class="toc">
  <div class="mobile-menu">
    <ul><li><a href="/pandora/en/introduce.html" alt="Documentation">Documentation</a></li><li><a href="/pandora/en/api.html" alt="API reference">API reference</a></li><li><a href="https://github.com/midwayjs/pandora/releases" alt="Change Log">Change Log</a></li></ul>
  </div>
  <dl><dt><a href="/pandora/en/introduce.html">What is the Pandora.js</a></dt></ul></dd><dt><a href="/pandora/en/quickstart.html">Quick Start</a></dt></ul></dd><dt><a href="/pandora/en/glossary.html">Glossary</a></dt></ul></dd><dt>Basic Features</dt><dd><ul><li><a href="/pandora/en/base/command.html">Commands</a></li><li><a href="/pandora/en/base/procfile_mode.html">Understand procfile.js</a></li><li><a href="/pandora/en/base/dorapan.html">User SDK - Dorapan</a></li><li><a href="/pandora/en/base/logs.html">Logger</a></li><li><a href="/pandora/en/base/global_config.html">Global Config</a></li><li><a href="/pandora/en/base/quick_monitor.html">Monitoring Quick Start</a></li><li><a href="/pandora/en/base/debug.html">Debugging</a></li></ul></dd><dt>Advanced Processes Model</dt><dd><ul><li><a href="/pandora/en/process/process_std.html">Custom Process</a></li><li><a href="/pandora/en/process/service_std.html">Custom Service</a></li><li><a href="/pandora/en/process/fork_and_cluster.html">Fork And Cluster</a></li><li><a href="/pandora/en/process/environment_std.html">Custom Environment</a></li><li><a href="/pandora/en/process/application_life_cycle.html">Application Life Cycle</a></li><li><a href="/pandora/en/process/ipc_hub.html">IPC-Hub</a></li></ul></dd><dt>Application Monitoring</dt><dd><ul><li><a href="/pandora/en/monitor/monitor_std.html">Overview of Monitoring</a></li><li><a href="/pandora/en/monitor/endpoint.html">EndPoint usage and extension</a></li><li><a href="/pandora/en/monitor/resource.html">Expose RESTFul API</a></li><li><a href="/pandora/en/monitor/metrics.html">Metrics usage and extension</a></li><li><a href="/pandora/en/monitor/trace.html">Trace Monitoring</a></li><li><a href="/pandora/en/monitor/monitor_inner.html">Base Monitoring</a></li><li><a href="/pandora/en/monitor/report.html">Monitoring Data Report</a></li></ul></dd><dt>Monitoring Data Collection</dt><dd><ul><li><a href="/pandora/en/collect/health.html">Health Check</a></li></ul></dd><dt>Extension</dt><dd><ul><li><a href="/pandora/en/other/dashboard.html">GUI Dashboard</a></li><li><a href="/pandora/en/other/typescript.html">Start A TypeScript Project</a></li></ul></dd></dl>
</aside>
<script>
var mobileTrigger = document.getElementById('mobileTrigger');
var mobileAside = document.getElementById('mobileAside');
mobileTrigger.onclick = function(e) {
  e.preventDefault();
  if (mobileAside.className.indexOf('mobile-show') === -1) {
    mobileAside.className += ' mobile-show';
  } else {
    mobileAside.className = 'toc';
  }
};
</script>

</div>

  </div>
</body>
<div class="cnzz">
<script src="https://s19.cnzz.com/z_stat.php?id=1271324644&web_id=1271324644" language="JavaScript"></script>
</div>

</html>
