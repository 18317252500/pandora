<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>EndPoint Usage and Extension</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/assets/css/styles.3a9f1cdc.css" as="style"><link rel="preload" href="/assets/js/app.3a9f1cdc.js" as="script"><link rel="preload" href="/assets/js/15.23fa35c0.js" as="script"><link rel="prefetch" href="/assets/js/28.cec8f2d2.js"><link rel="prefetch" href="/assets/css/1.styles.5a8ea794.css"><link rel="prefetch" href="/assets/js/1.5a8ea794.js"><link rel="prefetch" href="/assets/css/2.styles.6509c70d.css"><link rel="prefetch" href="/assets/js/2.6509c70d.js"><link rel="prefetch" href="/assets/js/3.8b7e0031.js"><link rel="prefetch" href="/assets/js/4.9744725a.js"><link rel="prefetch" href="/assets/js/5.42681610.js"><link rel="prefetch" href="/assets/js/6.5d7ec2de.js"><link rel="prefetch" href="/assets/js/7.b8138455.js"><link rel="prefetch" href="/assets/js/8.e076a4aa.js"><link rel="prefetch" href="/assets/js/9.e5e16c98.js"><link rel="prefetch" href="/assets/js/10.158db2a2.js"><link rel="prefetch" href="/assets/js/11.a671d306.js"><link rel="prefetch" href="/assets/js/12.d3b4cf81.js"><link rel="prefetch" href="/assets/js/13.cd4aef58.js"><link rel="prefetch" href="/assets/js/14.67de5e1b.js"><link rel="prefetch" href="/assets/js/16.932056a0.js"><link rel="prefetch" href="/assets/js/17.6b3b2d8d.js"><link rel="prefetch" href="/assets/js/18.d7a62273.js"><link rel="prefetch" href="/assets/js/19.094d0337.js"><link rel="prefetch" href="/assets/js/20.85c69cd6.js"><link rel="prefetch" href="/assets/js/21.b036638e.js"><link rel="prefetch" href="/assets/js/22.d745dd85.js"><link rel="prefetch" href="/assets/js/23.0aa8926b.js"><link rel="prefetch" href="/assets/js/24.ff8b4a3d.js"><link rel="prefetch" href="/assets/js/25.697e3d76.js"><link rel="prefetch" href="/assets/js/26.99c5150c.js"><link rel="prefetch" href="/assets/js/27.b44c6890.js"><link rel="prefetch" href="/assets/js/29.e7ccd45d.js"><link rel="prefetch" href="/assets/js/30.63a6b1c0.js"><link rel="prefetch" href="/assets/js/31.b761aeb7.js"><link rel="prefetch" href="/assets/js/32.a70d25f0.js"><link rel="prefetch" href="/assets/js/33.cd88dfdf.js"><link rel="prefetch" href="/assets/js/34.ccfe605c.js"><link rel="prefetch" href="/assets/js/35.0fb34bfe.js"><link rel="prefetch" href="/assets/js/36.9639fe30.js"><link rel="prefetch" href="/assets/js/37.3d70aba1.js"><link rel="prefetch" href="/assets/js/38.0d9de720.js"><link rel="prefetch" href="/assets/js/39.2954799a.js"><link rel="prefetch" href="/assets/js/40.b2bcddf7.js"><link rel="prefetch" href="/assets/js/41.3208960c.js"><link rel="prefetch" href="/assets/js/42.00947f66.js"><link rel="prefetch" href="/assets/js/43.1a8476d8.js"><link rel="prefetch" href="/assets/js/44.5e3a4f21.js"><link rel="prefetch" href="/assets/js/45.95a81b10.js"><link rel="prefetch" href="/assets/js/46.5d4bb088.js"><link rel="prefetch" href="/assets/js/47.fa2d11ba.js"><link rel="prefetch" href="/assets/js/48.d4d3396e.js"><link rel="prefetch" href="/assets/js/49.15ada0f8.js"><link rel="prefetch" href="/assets/js/50.8235420e.js"><link rel="prefetch" href="/assets/js/51.cba6e66f.js"><link rel="prefetch" href="/assets/js/52.05127c71.js"><link rel="prefetch" href="/assets/js/53.b9a2b2f4.js"><link rel="prefetch" href="/assets/js/54.742373fd.js"><link rel="prefetch" href="/assets/js/55.cd73c4f7.js"><link rel="prefetch" href="/assets/js/56.743d4627.js"><link rel="prefetch" href="/assets/js/57.d149a960.js"><link rel="prefetch" href="/assets/js/58.e3085eda.js"><link rel="prefetch" href="/assets/js/59.9b4e1542.js">
    <link rel="stylesheet" href="/assets/css/1.styles.5a8ea794.css"><link rel="stylesheet" href="/assets/css/2.styles.6509c70d.css"><link rel="stylesheet" href="/assets/css/styles.3a9f1cdc.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><!---->  <!----> </div> <div class="page"> <div class="content"><h1 id="endpoint-usage-and-extension"><a href="#endpoint-usage-and-extension" aria-hidden="true" class="header-anchor">#</a> EndPoint Usage and Extension</h1> <p>EndPoint are pre-defined acceptors in Daemon for collecting each process'es Indicator data and group them by applications.</p> <p>By default, Pandora.js provides a few EndPoint, all of them are open to user customization.</p> <h2 id="define-endpoint"><a href="#define-endpoint" aria-hidden="true" class="header-anchor">#</a> Define EndPoint</h2> <p>Every EndPoint includes a name to tag its' uniqueness. And because EndPoint initialization was completed in Daemon, only one EndPoint instance exist according to the unique tag.</p> <p>Each EndPoint is an IPC server, it accepts Indicator invocation results and summarises these data. Most commonly seen between theses methods are <code>invoke</code> and <code>processQueryResuts</code>, their definitions are as following:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IEndPoint</span> <span class="token punctuation">{</span>
  indicators<span class="token punctuation">:</span> Array<span class="token operator">&lt;</span>IIndicator<span class="token operator">&gt;</span><span class="token punctuation">;</span>
  group<span class="token punctuation">:</span> string<span class="token punctuation">;</span>
  <span class="token comment">/**
   * invoke the following metrics
   * @param appName
   * @param args
   */</span>
  <span class="token function">invoke</span><span class="token punctuation">(</span>appName<span class="token punctuation">:</span> string<span class="token punctuation">,</span> args<span class="token operator">?</span><span class="token punctuation">:</span> any<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * process responses
   */</span>
  <span class="token function">processQueryResults</span><span class="token punctuation">(</span>results<span class="token operator">?</span><span class="token punctuation">:</span> Array<span class="token operator">&lt;</span>IIndicatorResult<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token punctuation">:</span> any<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the above code we used <code>interface</code> for definition and add <code>group</code> field for the EndPoint so that every Indicator has the same <code>group</code> could be be reported to the same EndPoint.</p> <h2 id="define-indicator"><a href="#define-indicator" aria-hidden="true" class="header-anchor">#</a> Define Indicator</h2> <p>Each Indicator is an IPC client and initialized in different processes and sorted by pid. Generally speaking, one process only allow one Indicator which has the same name to exist. In cluster mode, Indicator can be used in various forms to report to EndPoint sharing the same group field name.</p> <p>Indicator has a few important fields, kind of similar with EndPoint, <code>group</code> indicates the link to specific EndPoint while <code>invoke</code> method executes the real logics.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">/**
 * single metric
 */</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">IIndicator</span> <span class="token punctuation">{</span>
  group<span class="token punctuation">:</span> string<span class="token punctuation">;</span>
  <span class="token function">invoke</span><span class="token punctuation">(</span>data<span class="token operator">?</span><span class="token punctuation">:</span> any<span class="token punctuation">,</span> builder<span class="token operator">?</span><span class="token punctuation">:</span> IBuilder<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="convention-of-configuration"><a href="#convention-of-configuration" aria-hidden="true" class="header-anchor">#</a> Convention of Configuration</h2> <p>Configuration may differ between versions but most of it would be like this:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  actuator<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    endPoint<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      error<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        target<span class="token punctuation">:</span> ErrorEndPoint<span class="token punctuation">,</span>
        resource<span class="token punctuation">:</span> ErrorResource<span class="token punctuation">,</span>
        initConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          maxErrorCount<span class="token punctuation">:</span> <span class="token number">100</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      health<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        target<span class="token punctuation">:</span> HealthEndPoint<span class="token punctuation">,</span>
        resource<span class="token punctuation">:</span> HealthResource<span class="token punctuation">,</span>
        initConfig<span class="token punctuation">:</span> <span class="token punctuation">{</span>
          port<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            checkUrl<span class="token punctuation">:</span> <span class="token template-string"><span class="token string">`http://127.1:6001`</span></span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          disk_space<span class="token punctuation">:</span> <span class="token punctuation">{</span>
            enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            rate<span class="token punctuation">:</span> <span class="token number">80</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      process<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        target<span class="token punctuation">:</span> ProcessEndPoint<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      metrics<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        target<span class="token punctuation">:</span> MetricsEndPoint<span class="token punctuation">,</span>
        resource<span class="token punctuation">:</span> MetricsResource
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Each EndPoint has a few common configurations:</p> <ul><li>name {String} unique globally</li> <li>enabled {Boolean} enabled or not</li> <li>target {IEndPoint} corresponding EndPoint class</li> <li>resource {ActuatorResource} corresponding Resource class</li> <li>initConfig {Object} initialization configuration</li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code>metrics<span class="token punctuation">:</span> <span class="token punctuation">{</span>
  enabled<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  target<span class="token punctuation">:</span> MetricsEndPoint<span class="token punctuation">,</span>
  resource<span class="token punctuation">:</span> MetricsResource
<span class="token punctuation">}</span>
</code></pre></div><p>Above is the code for EndPoint configuration.</p></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/15.23fa35c0.js" defer></script><script src="/assets/js/app.3a9f1cdc.js" defer></script>
  </body>
</html>
