<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <title>Contributing to Pandora.js - 向未来出发</title>
  <meta charset="utf-8">
  <meta name="description" content="index.description">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/2/docsearch.min.css" />
<link rel="stylesheet" href="/pandora/css/index.css">

</head>
<body>
  <div class="nav" >
  <header>
    <a href="/pandora/zh-cn" class="nav-logo leftpadding" alt="Pandora.js"><img src="/pandora/images/nav-logo.png" > Pandora.js</a>
    <ul class="nav-item">
      <li><a href="/pandora/zh-cn/introduce.html" alt="文档指南">文档指南</a></li><li><a href="/pandora/zh-cn/api.html" alt="API 接口">API 接口</a></li><li><a href="https://github.com/midwayjs/pandora/releases" alt="发布日志">发布日志</a></li>
      <li class="translations">
        <a class="nav-link">Language - 中文</a>
        <span class="arrow" style="border-top-color:#fff" ></span>
        <ul class="dropdown-content" >
          <li style="display: block; margin-left: 20px" ><a style="color: #008ce6" href="/pandora/zh-cn">中文</a></li>
          <li style="display: block; margin-left: 20px" ><a style="color: #008ce6" href="/pandora/en">English</a></li>
        </ul>
      </li>
      <li><iframe src="https://ghbtns.com/github-btn.html?user=midwayjs&repo=pandora&type=star&count=true" frameborder="0" scrolling="0" width="150px" height="20px"></iframe></li>
    </ul>
    <a id="mobileTrigger" href="#" class="mobile-trigger">
      <ul>
        <li></li>
        <li></li>
        <li></li>
      </ul>
    </a>
  </header>
</div>

  <div id="container" class="container">
    <div class="page-main">
  <article class="markdown-body">
    <h1>Contributing to Pandora.js</h1>
    <h2 id="开发规范"><a class="markdown-anchor" href="#开发规范">#</a> 开发规范</h2>
<h3 id="多个-npm-包在一个仓库"><a class="markdown-anchor" href="#多个-npm-包在一个仓库">#</a> 多个 NPM 包在一个仓库？</h3>
<p>是的，我们是一个包在一个仓库，我们使用了 lerna 来管理这些包，实现关联和统一发布、管理。</p>
<h3 id="我们目录结构如下"><a class="markdown-anchor" href="#我们目录结构如下">#</a> 我们目录结构如下</h3>
<ul>
<li>scripts =&gt; 一些脚本</li>
<li>packages =&gt; 所有的包都在这下面
<ul>
<li>某个具体的 NPM 包
<ul>
<li>src 源代码</li>
<li>dist 编译后的代码</li>
<li>test 功能测试</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="每个-package-应该暴露的命令"><a class="markdown-anchor" href="#每个-package-应该暴露的命令">#</a> 每个 Package 应该暴露的命令</h3>
<ul>
<li>npm run build =&gt; 编译</li>
<li>npm run lint =&gt; 执行对 test、src 目录的 lint</li>
<li>npm run test =&gt; 执行测试</li>
<li>npm run cov =&gt; 覆盖率</li>
<li>npm run gen-api-ref =&gt; 生成 API-Reference</li>
</ul>
<h3 id="根目录暴露的命令"><a class="markdown-anchor" href="#根目录暴露的命令">#</a> 根目录暴露的命令</h3>
<ul>
<li>npm run bootstrap =&gt; lerna bootstrap</li>
<li>npm run test =&gt; 对所有 packages 执行单元测试</li>
<li>npm run cov =&gt; 对所有 packages 执行覆盖率测试</li>
<li>npm run build =&gt; 对所有 packages 执行 build</li>
<li>npm run publish =&gt; 发布到 npm</li>
<li>npm run clean =&gt; lerna clean</li>
<li>npm run purge =&gt; 清除所有依赖</li>
<li>npm run gen-api-ref =&gt; 生成全部 API-Reference</li>
<li>npm run ci =&gt; 执行 CI</li>
</ul>
<h3 id="开发新功能"><a class="markdown-anchor" href="#开发新功能">#</a> 开发新功能</h3>
<ol>
<li>checkout 新分支 features/xxx</li>
<li>开发功能</li>
<li>向提交 develop merge （通过 MR 或 PR）</li>
<li>合并至 develop</li>
</ol>
<h3 id="如何执行单元测试"><a class="markdown-anchor" href="#如何执行单元测试">#</a> 如何执行单元测试</h3>
<ul>
<li>npm run test</li>
<li>亦可通过 IDE 执行 Mocha</li>
</ul>
<h2 id="质量控制"><a class="markdown-anchor" href="#质量控制">#</a> 质量控制</h2>
<h3 id="单元测试相关"><a class="markdown-anchor" href="#单元测试相关">#</a> 单元测试相关</h3>
<ol>
<li>工具
<ul>
<li>测试框架：Mocha</li>
<li>断言工具：chai 的 expect 形式</li>
<li>Mock工具：mm</li>
<li>覆盖率工具：istanbul</li>
</ul>
</li>
<li>要求
<ul>
<li>测试覆盖率：Statement 90% 以上，Branch 80% 以上</li>
</ul>
</li>
</ol>
<h3 id="静态分析"><a class="markdown-anchor" href="#静态分析">#</a> 静态分析</h3>
<p>提高软件的鲁棒性、安全性，需要对软件进行一些静态的分析与约束</p>
<ol>
<li>
<p>类型系统</p>
<ul>
<li>引入 TypeScript</li>
<li>类型系统可以提供一些类似 Interface 的约束，或类型推断分析的能力，对于发现软件问题较为有用</li>
</ul>
</li>
<li>
<p>三方包检查</p>
<ul>
<li>使用 nsp</li>
<li>在集成中执行 nsp</li>
</ul>
</li>
</ol>
<h3 id="代码风格"><a class="markdown-anchor" href="#代码风格">#</a> 代码风格</h3>
<ol>
<li>工具
<ul>
<li>使用 TSLint 检查代码风格</li>
</ul>
</li>
<li>执行方式
<ul>
<li>构建之前</li>
</ul>
</li>
</ol>
<h3 id="debug-埋点规范"><a class="markdown-anchor" href="#debug-埋点规范">#</a> debug 埋点规范</h3>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const debug = require(&apos;debug&apos;)(&apos;pandora:pakageName:ClassName&apos;);</span><br></pre></td></tr></table></figure>
<ul>
<li>直接require一个debug包</li>
<li>埋点名称由三部分组成
<ul>
<li><code>pandora</code></li>
<li>包名称</li>
<li>类名或组件名</li>
</ul>
</li>
</ul>
<h3 id="文档规范"><a class="markdown-anchor" href="#文档规范">#</a> 文档规范</h3>
<ol>
<li>工具
<ul>
<li>typedoc 生成 API-Reference</li>
</ul>
</li>
</ol>
<!--

### 关于版本

1. Pandora.js 下的所有版本都是固定的，所有的更新都体现在 Pandora.js 的版本变化上
2. 类似 Linux 偶数表示稳固版本，奇数表示开发中版本

### 操作系统

* Linux
* Mac
* Window // 不主要关注

-->

  </article>
  <aside id="mobileAside" class="toc">
  <div class="mobile-menu">
    <ul><li><a href="/pandora/zh-cn/introduce.html" alt="文档指南">文档指南</a></li><li><a href="/pandora/zh-cn/api.html" alt="API 接口">API 接口</a></li><li><a href="https://github.com/midwayjs/pandora/releases" alt="发布日志">发布日志</a></li></ul>
  </div>
  <dl><dt><a href="/pandora/zh-cn/introduce.html">Pandora.js 是什么？</a></dt></ul></dd><dt><a href="/pandora/zh-cn/quickstart.html">快速入门</a></dt></ul></dd><dt><a href="/pandora/zh-cn/glossary.html">关键术语</a></dt></ul></dd><dt>基础功能</dt><dd><ul><li><a href="/pandora/zh-cn/base/command.html">命令行介绍</a></li><li><a href="/pandora/zh-cn/other/dashboard.html">可视化管理面板</a></li><li><a href="/pandora/zh-cn/base/procfile_mode.html">认识 procfile.js</a></li><li><a href="/pandora/zh-cn/base/dorapan.html">用户空间 SDK - Dorapan</a></li><li><a href="/pandora/zh-cn/base/logs.html">日志管理</a></li><li><a href="/pandora/zh-cn/base/global_config.html">全局配置</a></li><li><a href="/pandora/zh-cn/base/quick_monitor.html">快速了解监控</a></li><li><a href="/pandora/zh-cn/base/debug.html">调试应用</a></li></ul></dd><dt>进程管理进阶</dt><dd><ul><li><a href="/pandora/zh-cn/process/process_std.html">自定义进程</a></li><li><a href="/pandora/zh-cn/process/service_std.html">自定义 Service</a></li><li><a href="/pandora/zh-cn/process/fork_and_cluster.html">Fork 和 Cluster</a></li><li><a href="/pandora/zh-cn/process/environment_std.html">自定义环境</a></li><li><a href="/pandora/zh-cn/process/application_life_cycle.html">应用生命周期</a></li><li><a href="/pandora/zh-cn/process/ipc_hub.html">进程间通信</a></li></ul></dd><dt>应用监控</dt><dd><ul><li><a href="/pandora/zh-cn/monitor/monitor_std.html">监控体系总览</a></li><li><a href="/pandora/zh-cn/monitor/resource.html">对外暴露的 Restful API</a></li><li><a href="/pandora/zh-cn/monitor/trace.html">链路追踪及监控</a></li><li><a href="/pandora/zh-cn/monitor/monitor_inner.html">内置的监控</a></li><li><a href="/pandora/zh-cn/monitor/endpoint.html">使用和扩展 EndPoint</a></li><li><a href="/pandora/zh-cn/monitor/metrics.html">使用和扩展 Metrics</a></li><li><a href="/pandora/zh-cn/monitor/report.html">监控数据上报</a></li></ul></dd><dt>监控数据采集</dt><dd><ul><li><a href="/pandora/zh-cn/collect/health.html">健康检查</a></li></ul></dd><dt>扩展功能</dt><dd><ul><li><a href="/pandora/zh-cn/other/typescript.html">启动 TypeScript 项目</a></li></ul></dd></dl>
</aside>
<script>
var mobileTrigger = document.getElementById('mobileTrigger');
var mobileAside = document.getElementById('mobileAside');
mobileTrigger.onclick = function(e) {
  e.preventDefault();
  if (mobileAside.className.indexOf('mobile-show') === -1) {
    mobileAside.className += ' mobile-show';
  } else {
    mobileAside.className = 'toc';
  }
};
</script>

</div>

  </div>
</body>
<div class="cnzz">
<script src="https://s19.cnzz.com/z_stat.php?id=1271324644&web_id=1271324644" language="JavaScript"></script>
</div>

</html>
